import org.springframework.stereotype.Controller;
import org.springframework.ui.Model;
import org.springframework.web.bind.annotation.GetMapping;

import java.text.SimpleDateFormat;
import java.util.Calendar;
import java.util.Date;

@Controller
public class CountdownController {
    @GetMapping("/countdown")
    public String countdown(Model model) {
        // Set initial date (for example: today)
        Calendar calendar = Calendar.getInstance();
        
        // Add 2 working days (skip weekends)
        int daysToAdd = 2;
        while (daysToAdd > 0) {
            calendar.add(Calendar.DAY_OF_MONTH, 1);
            int dayOfWeek = calendar.get(Calendar.DAY_OF_WEEK);
            if (dayOfWeek != Calendar.SATURDAY && dayOfWeek != Calendar.SUNDAY) {
                daysToAdd--;
            }
        }

        // Format the final expiration date to pass as a string
        SimpleDateFormat dateFormat = new SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss");
        model.addAttribute("expirationDate", dateFormat.format(calendar.getTime()));
        
        return "countdown";
    }
}


<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Countdown Timer</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <style>
        .countdown-container {
            text-align: center;
            font-size: 2em;
            padding: 20px;
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <div class="countdown-container">
        <div id="countdown" class="display-4"></div>
    </div>

    <script>
        // Get the expiration date passed from Spring MVC
        const expirationDate = new Date("<%= expirationDate %>");

        // Update the countdown every 1 second
        const countdown = setInterval(() => {
            const now = new Date().getTime();
            const distance = expirationDate.getTime() - now;

            // Time calculations
            const days = Math.floor(distance / (1000 * 60 * 60 * 24));
            const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
            const seconds = Math.floor((distance % (1000 * 60)) / 1000);

            // Display the result
            document.getElementById("countdown").innerHTML = 
                days + "d " + hours + "h " + minutes + "m " + seconds + "s ";

            // If the countdown is finished
            if (distance < 0) {
                clearInterval(countdown);
                document.getElementById("countdown").innerHTML = "EXPIRED";
            }
        }, 1000);
    </script>
</body>
</html>
